添加安全域名
Web应用需要将域名添加到【环境】-【安全配置】-【WEB安全域名】列表中，否则将被识别为非法来源。。点击前往配置

2
在应用中引入云开发 SDK
(tWeb端复制下方的代码片段，将其粘贴到您的HTML代码底部，其他script标记之前)。

<script src="https://static.cloudbase.net/cloudbase-js-sdk/2.19.2/cloudbase.full.js"></script>
<script>
  const app = cloudbase.init({
    env: 'wuby-9gk84z40475927ab' // 您的环境id
  })
</script>
微信小程序端通过npm安装sdk，然后引入。

npm install @cloudbase/js-sdk@2.19.2

// 代码中使用
const cloudbase = require(" @cloudbase/js-sdk")
const app = cloudbase.init({
  env: 'wuby-9gk84z40475927ab' // 您的环境id
})
3
客户端SDK用户名密码登录
绑定用户名成功后，可以使用用户名密码登录。详情可参考用户名密码登录。
const auth = app.auth()
// 用户名密码登录
await auth.signIn({
  username: "your username",
  password: "your password",
});

登录认证
提示
新登录体系下，确保一个环境对应一个 tcb 实例（避免多次初始化相同环境的 tcb 实例）

App.auth()
接口描述
返回 Auth 对象

签名：auth(): Auth

危险
@cloudbase/js-sdk@2.x 版本将只支持 local 方式（Web 端在显式退出登录之前 30 天保留身份验证状态）存储身份状态。（原 1.x 版本的 session 及 none 模式不再支持）

示例代码
import cloudbase from "@cloudbase/js-sdk";

const app = cloudbase.init({
  env: "xxxx-yyy",
  clientId: "xxxx",
});

const auth = app.auth();

注册/登录/登出相关
Auth.signUp
接口描述
接口功能：注册用户，目前支持手机号验证码注册，邮箱验证码注册。

接口声明：signUp(params: SignUpRequest): Promise<LoginState>

SignUpRequest
字段	类型	必填	说明
phone_number	string	否	注册所用手机号，phone_number 与 email 必须任选其一使用
email	string	否	注册所用邮箱 ，phone_number 与 email 必须任选其一使用
verification_code	string	否	验证码
verification_token	string	否	验证码 token
provider_token	string	否	第三方 provider token
password	string	否	密码
name	string	否	用户名
gender	string	否	性别
picture	string	否	头像
locale	string	否	地址
示例代码
Javascript
Bash
// 初始化SDK
const app = cloudbase.init({
  env: "xxxx-yyy",
  clientId: "xxxxx",
});

const auth = app.auth();

// 例：手机号验证码注册

// 1. 发送手机验证码
const phoneNumber = "+86 13800000000";
const verification = await auth.getVerification({
  phone_number: phoneNumber,
});

// 若使用邮箱验证，第一步代码改为
const email = "test@example.com";
const verification = await auth.getVerification({
  email: email,
});

// 2. 验证码验证
// 调用发送短信接口后，手机将会收到云开发的短信验证码。
// 用户填入短信验证码，可以调用下面的接口进行验证。

// 假设已收到用户填入的验证码"000000"
const verificationCode = "000000";
// 验证验证码的正确性
const verificationTokenRes = await auth.verify({
  verification_id: verification.verification_id,
  verification_code: verificationCode,
});

// 3. 注册
// 如果该用户已经存，则登录
if (verification.is_user) {
  await auth.signIn({
    username: phoneNumber,
    verification_token: verificationTokenRes.verification_token,
  });
} else {
  // 否则，则注册新用户，注册新用户时，可以设置密码，用户名
  // 备注：signUp 成功后，会自动登录
  await auth.signUp({
    phone_number: phoneNumber,
    verification_code: verificationCode,
    verification_token: verificationTokenRes.verification_token,
    // 可选，设置昵称
    name: "手机用户",
    // 可选，设置密码
    password: "password",
    // 可选，设置登录用户名
    username: "username",
  });
}

Auth.signIn
接口描述
接口功能：登录用户，目前支持手机号，邮箱，用户名密码登录。

接口声明：signIn(params: SignInRequest): Promise<LoginState>

SignInRequest
字段	类型	必填	说明
username	string	是	用户手机号，邮箱或自定义用户名
password	string	否	用户密码 ，password 与 verification_token 必须任选其一
verification_token	string	否	验证码 token ，password 与 verification_token 必须任选其一
示例代码
Javascript
Bash
const app = cloudbase.init({
  env: "xxxx-yyy",
  clientId: "xxxxx",
});

const auth = app.auth();

// 已完成注册
// 例：手机号登录
const phoneNumber = "+86 13800000000";

await auth.signIn({
  username: phoneNumber,
  password: "your password",
});

// 例：邮箱登录
const email = "test@example.com";

await auth.signIn({
  username: email,
  password: "your password",
});

// 例：用户名登录
const username = "myname";
await auth.signIn({
  username,
  password: "your password",
});

Auth.signOut()
接口描述
登出云开发

签名：signOut(): Promise<void>

示例代码
Javascript
Bash
const app = cloudbase.init({
  env: "xxxx-yyy",
});

const auth = app.auth();

await auth.signOut();